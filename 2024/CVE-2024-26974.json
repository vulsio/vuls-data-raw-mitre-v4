{
	"name": "CVE-2024-26974",
	"seq": "2024-26974",
	"type": "CAN",
	"status": "Candidate",
	"phase": {
		"text": "Assigned",
		"date": "20240219"
	},
	"desc": "In the Linux kernel, the following vulnerability has been resolved: crypto: qat - resolve race condition during AER recovery During the PCI AER system's error recovery process, the kernel driver may encounter a race condition with freeing the reset_data structure's memory. If the device restart will take more than 10 seconds the function scheduling that restart will exit due to a timeout, and the reset_data structure will be freed. However, this data structure is used for completion notification after the restart is completed, which leads to a UAF bug. This results in a KFENCE bug notice. BUG: KFENCE: use-after-free read in adf_device_reset_worker+0x38/0xa0 [intel_qat] Use-after-free read at 0x00000000bc56fddf (in kfence-#142): adf_device_reset_worker+0x38/0xa0 [intel_qat] process_one_work+0x173/0x340 To resolve this race condition, the memory associated to the container of the work_struct is freed on the worker if the timeout expired, otherwise on the function that schedules the worker. The timeout detection can be done by checking if the caller is still waiting for completion or not by using completion_done() function.",
	"refs": [
		{
			"text": "https://git.kernel.org/stable/c/0c2cf5142bfb634c0ef0a1a69cdf37950747d0be",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/0c2cf5142bfb634c0ef0a1a69cdf37950747d0be"
		},
		{
			"text": "https://git.kernel.org/stable/c/226fc408c5fcd23cc4186f05ea3a09a7a9aef2f7",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/226fc408c5fcd23cc4186f05ea3a09a7a9aef2f7"
		},
		{
			"text": "https://git.kernel.org/stable/c/4ae5a97781ce7d6ecc9c7055396535815b64ca4f",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/4ae5a97781ce7d6ecc9c7055396535815b64ca4f"
		},
		{
			"text": "https://git.kernel.org/stable/c/7d42e097607c4d246d99225bf2b195b6167a210c",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/7d42e097607c4d246d99225bf2b195b6167a210c"
		},
		{
			"text": "https://git.kernel.org/stable/c/8a5a7611ccc7b1fba8d933a9f22a2e76859d94dc",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/8a5a7611ccc7b1fba8d933a9f22a2e76859d94dc"
		},
		{
			"text": "https://git.kernel.org/stable/c/8e81cd58aee14a470891733181a47d123193ba81",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/8e81cd58aee14a470891733181a47d123193ba81"
		},
		{
			"text": "https://git.kernel.org/stable/c/bb279ead42263e9fb09480f02a4247b2c287d828",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/bb279ead42263e9fb09480f02a4247b2c287d828"
		},
		{
			"text": "https://git.kernel.org/stable/c/d03092550f526a79cf1ade7f0dfa74906f39eb71",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/d03092550f526a79cf1ade7f0dfa74906f39eb71"
		},
		{
			"text": "https://git.kernel.org/stable/c/daba62d9eeddcc5b1081be7d348ca836c83c59d7",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/daba62d9eeddcc5b1081be7d348ca836c83c59d7"
		}
	],
	"votes": {}
}
