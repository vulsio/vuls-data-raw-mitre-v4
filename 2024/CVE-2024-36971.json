{
	"name": "CVE-2024-36971",
	"seq": "2024-36971",
	"type": "CAN",
	"status": "Candidate",
	"phase": {
		"text": "Assigned",
		"date": "20240530"
	},
	"desc": "In the Linux kernel, the following vulnerability has been resolved: net: fix __dst_negative_advice() race __dst_negative_advice() does not enforce proper RCU rules when sk->dst_cache must be cleared, leading to possible UAF. RCU rules are that we must first clear sk->sk_dst_cache, then call dst_release(old_dst). Note that sk_dst_reset(sk) is implementing this protocol correctly, while __dst_negative_advice() uses the wrong order. Given that ip6_negative_advice() has special logic against RTF_CACHE, this means each of the three ->negative_advice() existing methods must perform the sk_dst_reset() themselves. Note the check against NULL dst is centralized in __dst_negative_advice(), there is no need to duplicate it in various callbacks. Many thanks to Clement Lecigne for tracking this issue. This old bug became visible after the blamed commit, using UDP sockets.",
	"refs": [
		{
			"text": "https://git.kernel.org/stable/c/051c0bde9f0450a2ec3d62a86d2a0d2fad117f13",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/051c0bde9f0450a2ec3d62a86d2a0d2fad117f13"
		},
		{
			"text": "https://git.kernel.org/stable/c/2295a7ef5c8c49241bff769e7826ef2582e532a6",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/2295a7ef5c8c49241bff769e7826ef2582e532a6"
		},
		{
			"text": "https://git.kernel.org/stable/c/5af198c387128a9d2ddd620b0f0803564a4d4508",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/5af198c387128a9d2ddd620b0f0803564a4d4508"
		},
		{
			"text": "https://git.kernel.org/stable/c/81dd3c82a456b0015461754be7cb2693991421b4",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/81dd3c82a456b0015461754be7cb2693991421b4"
		},
		{
			"text": "https://git.kernel.org/stable/c/92f1655aa2b2294d0b49925f3b875a634bd3b59e",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/92f1655aa2b2294d0b49925f3b875a634bd3b59e"
		},
		{
			"text": "https://git.kernel.org/stable/c/b8af8e6118a6605f0e495a58d591ca94a85a50fc",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/b8af8e6118a6605f0e495a58d591ca94a85a50fc"
		},
		{
			"text": "https://git.kernel.org/stable/c/db0082825037794c5dba9959c9de13ca34cc5e72",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/db0082825037794c5dba9959c9de13ca34cc5e72"
		},
		{
			"text": "https://git.kernel.org/stable/c/eacb8b195579c174a6d3e12a9690b206eb7f28cf",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/eacb8b195579c174a6d3e12a9690b206eb7f28cf"
		}
	],
	"votes": {}
}
