{
	"name": "CVE-2024-26883",
	"seq": "2024-26883",
	"type": "CAN",
	"status": "Candidate",
	"phase": {
		"text": "Assigned",
		"date": "20240219"
	},
	"desc": "In the Linux kernel, the following vulnerability has been resolved: bpf: Fix stackmap overflow check on 32-bit arches The stackmap code relies on roundup_pow_of_two() to compute the number of hash buckets, and contains an overflow check by checking if the resulting value is 0. However, on 32-bit arches, the roundup code itself can overflow by doing a 32-bit left-shift of an unsigned long value, which is undefined behaviour, so it is not guaranteed to truncate neatly. This was triggered by syzbot on the DEVMAP_HASH type, which contains the same check, copied from the hashtab code. The commit in the fixes tag actually attempted to fix this, but the fix did not account for the UB, so the fix only works on CPUs where an overflow does result in a neat truncation to zero, which is not guaranteed. Checking the value before rounding does not have this problem.",
	"refs": [
		{
			"text": "https://git.kernel.org/stable/c/0971126c8164abe2004b8536b49690a0d6005b0a",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/0971126c8164abe2004b8536b49690a0d6005b0a"
		},
		{
			"text": "https://git.kernel.org/stable/c/15641007df0f0d35fa28742b25c2a7db9dcd6895",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/15641007df0f0d35fa28742b25c2a7db9dcd6895"
		},
		{
			"text": "https://git.kernel.org/stable/c/21e5fa4688e1a4d3db6b72216231b24232f75c1d",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/21e5fa4688e1a4d3db6b72216231b24232f75c1d"
		},
		{
			"text": "https://git.kernel.org/stable/c/43f798b9036491fb014b55dd61c4c5c3193267d0",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/43f798b9036491fb014b55dd61c4c5c3193267d0"
		},
		{
			"text": "https://git.kernel.org/stable/c/7070b274c7866a4c5036f8d54fcaf315c64ac33a",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/7070b274c7866a4c5036f8d54fcaf315c64ac33a"
		},
		{
			"text": "https://git.kernel.org/stable/c/7a4b21250bf79eef26543d35bd390448646c536b",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/7a4b21250bf79eef26543d35bd390448646c536b"
		},
		{
			"text": "https://git.kernel.org/stable/c/ca1f06e72dec41ae4f76e7b1a8a97265447b46ae",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/ca1f06e72dec41ae4f76e7b1a8a97265447b46ae"
		},
		{
			"text": "https://git.kernel.org/stable/c/d0e214acc59145ce25113f617311aa79dda39cb3",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/d0e214acc59145ce25113f617311aa79dda39cb3"
		},
		{
			"text": "https://git.kernel.org/stable/c/f06899582ccee09bd85d0696290e3eaca9aa042d",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/f06899582ccee09bd85d0696290e3eaca9aa042d"
		}
	],
	"votes": {}
}
