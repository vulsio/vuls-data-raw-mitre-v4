{
	"name": "CVE-2024-27414",
	"seq": "2024-27414",
	"type": "CAN",
	"status": "Candidate",
	"phase": {
		"text": "Assigned",
		"date": "20240225"
	},
	"desc": "In the Linux kernel, the following vulnerability has been resolved: rtnetlink: fix error logic of IFLA_BRIDGE_FLAGS writing back In the commit d73ef2d69c0d (\"rtnetlink: let rtnl_bridge_setlink checks IFLA_BRIDGE_MODE length\"), an adjustment was made to the old loop logic in the function `rtnl_bridge_setlink` to enable the loop to also check the length of the IFLA_BRIDGE_MODE attribute. However, this adjustment removed the `break` statement and led to an error logic of the flags writing back at the end of this function. if (have_flags) memcpy(nla_data(attr), &flags, sizeof(flags)); // attr should point to IFLA_BRIDGE_FLAGS NLA !!! Before the mentioned commit, the `attr` is granted to be IFLA_BRIDGE_FLAGS. However, this is not necessarily true fow now as the updated loop will let the attr point to the last NLA, even an invalid NLA which could cause overflow writes. This patch introduces a new variable `br_flag` to save the NLA pointer that points to IFLA_BRIDGE_FLAGS and uses it to resolve the mentioned error logic.",
	"refs": [
		{
			"text": "https://git.kernel.org/stable/c/167d8642daa6a44b51de17f8ff0f584e1e762db7",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/167d8642daa6a44b51de17f8ff0f584e1e762db7"
		},
		{
			"text": "https://git.kernel.org/stable/c/743ad091fb46e622f1b690385bb15e3cd3daf874",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/743ad091fb46e622f1b690385bb15e3cd3daf874"
		},
		{
			"text": "https://git.kernel.org/stable/c/831bc2728fb48a8957a824cba8c264b30dca1425",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/831bc2728fb48a8957a824cba8c264b30dca1425"
		},
		{
			"text": "https://git.kernel.org/stable/c/882a51a10ecf24ce135d573afa0872aef02c5125",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/882a51a10ecf24ce135d573afa0872aef02c5125"
		},
		{
			"text": "https://git.kernel.org/stable/c/a1227b27fcccc99dc44f912b479e01a17e2d7d31",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/a1227b27fcccc99dc44f912b479e01a17e2d7d31"
		},
		{
			"text": "https://git.kernel.org/stable/c/b9fbc44159dfc3e9a7073032752d9e03f5194a6f",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/b9fbc44159dfc3e9a7073032752d9e03f5194a6f"
		},
		{
			"text": "https://git.kernel.org/stable/c/f2261eb994aa5757c1da046b78e3229a3ece0ad9",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/f2261eb994aa5757c1da046b78e3229a3ece0ad9"
		}
	],
	"votes": {}
}
