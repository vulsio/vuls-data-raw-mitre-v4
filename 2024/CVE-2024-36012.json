{
	"name": "CVE-2024-36012",
	"seq": "2024-36012",
	"type": "CAN",
	"status": "Candidate",
	"phase": {
		"text": "Assigned",
		"date": "20240517"
	},
	"desc": "In the Linux kernel, the following vulnerability has been resolved: Bluetooth: msft: fix slab-use-after-free in msft_do_close() Tying the msft->data lifetime to hdev by freeing it in hci_release_dev() to fix the following case: [use] msft_do_close() msft = hdev->msft_data; if (!msft) ...(1) <- passed. return; mutex_lock(&msft->filter_lock); ...(4) <- used after freed. [free] msft_unregister() msft = hdev->msft_data; hdev->msft_data = NULL; ...(2) kfree(msft); ...(3) <- msft is freed. ================================================================== BUG: KASAN: slab-use-after-free in __mutex_lock_common kernel/locking/mutex.c:587 [inline] BUG: KASAN: slab-use-after-free in __mutex_lock+0x8f/0xc30 kernel/locking/mutex.c:752 Read of size 8 at addr ffff888106cbbca8 by task kworker/u5:2/309",
	"refs": [
		{
			"text": "https://git.kernel.org/stable/c/10f9f426ac6e752c8d87bf4346930ba347aaabac",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/10f9f426ac6e752c8d87bf4346930ba347aaabac"
		},
		{
			"text": "https://git.kernel.org/stable/c/4f1de02de07748da80a8178879bc7a1df37fdf56",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/4f1de02de07748da80a8178879bc7a1df37fdf56"
		},
		{
			"text": "https://git.kernel.org/stable/c/a85a60e62355e3bf4802dead7938966824b23940",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/a85a60e62355e3bf4802dead7938966824b23940"
		},
		{
			"text": "https://git.kernel.org/stable/c/e3880b531b68f98d3941d83f2f6dd11cf4fd6b76",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/e3880b531b68f98d3941d83f2f6dd11cf4fd6b76"
		}
	],
	"votes": {}
}
