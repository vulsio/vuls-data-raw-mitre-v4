{
	"name": "CVE-2024-35811",
	"seq": "2024-35811",
	"type": "CAN",
	"status": "Candidate",
	"phase": {
		"text": "Assigned",
		"date": "20240517"
	},
	"desc": "In the Linux kernel, the following vulnerability has been resolved: wifi: brcmfmac: Fix use-after-free bug in brcmf_cfg80211_detach This is the candidate patch of CVE-2023-47233 : https://nvd.nist.gov/vuln/detail/CVE-2023-47233 In brcm80211 driver,it starts with the following invoking chain to start init a timeout worker: ->brcmf_usb_probe ->brcmf_usb_probe_cb ->brcmf_attach ->brcmf_bus_started ->brcmf_cfg80211_attach ->wl_init_priv ->brcmf_init_escan ->INIT_WORK(&cfg->escan_timeout_work, brcmf_cfg80211_escan_timeout_worker); If we disconnect the USB by hotplug, it will call brcmf_usb_disconnect to make cleanup. The invoking chain is : brcmf_usb_disconnect ->brcmf_usb_disconnect_cb ->brcmf_detach ->brcmf_cfg80211_detach ->kfree(cfg); While the timeout woker may still be running. This will cause a use-after-free bug on cfg in brcmf_cfg80211_escan_timeout_worker. Fix it by deleting the timer and canceling the worker in brcmf_cfg80211_detach. [arend.vanspriel@broadcom.com: keep timer delete as is and cancel work just before free]",
	"refs": [
		{
			"text": "https://git.kernel.org/stable/c/0a7591e14a8da794d0b93b5d1c6254ccb23adacb",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/0a7591e14a8da794d0b93b5d1c6254ccb23adacb"
		},
		{
			"text": "https://git.kernel.org/stable/c/0b812f706fd7090be74812101114a0e165b36744",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/0b812f706fd7090be74812101114a0e165b36744"
		},
		{
			"text": "https://git.kernel.org/stable/c/0f7352557a35ab7888bc7831411ec8a3cbe20d78",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/0f7352557a35ab7888bc7831411ec8a3cbe20d78"
		},
		{
			"text": "https://git.kernel.org/stable/c/190794848e2b9d15de92d502b6ac652806904f5a",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/190794848e2b9d15de92d502b6ac652806904f5a"
		},
		{
			"text": "https://git.kernel.org/stable/c/202c503935042272e2f9e1bb549d5f69a8681169",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/202c503935042272e2f9e1bb549d5f69a8681169"
		},
		{
			"text": "https://git.kernel.org/stable/c/6678a1e7d896c00030b31491690e8ddc9a90767a",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/6678a1e7d896c00030b31491690e8ddc9a90767a"
		},
		{
			"text": "https://git.kernel.org/stable/c/8c36205123dc57349b59b4f1a2301eb278cbc731",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/8c36205123dc57349b59b4f1a2301eb278cbc731"
		},
		{
			"text": "https://git.kernel.org/stable/c/8e3f03f4ef7c36091f46e7349096efb5a2cdb3a1",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/8e3f03f4ef7c36091f46e7349096efb5a2cdb3a1"
		},
		{
			"text": "https://git.kernel.org/stable/c/bacb8c3ab86dcd760c15903fcee58169bc3026aa",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/bacb8c3ab86dcd760c15903fcee58169bc3026aa"
		}
	],
	"votes": {}
}
