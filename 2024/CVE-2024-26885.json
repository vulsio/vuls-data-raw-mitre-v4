{
	"name": "CVE-2024-26885",
	"seq": "2024-26885",
	"type": "CAN",
	"status": "Candidate",
	"phase": {
		"text": "Assigned",
		"date": "20240219"
	},
	"desc": "In the Linux kernel, the following vulnerability has been resolved: bpf: Fix DEVMAP_HASH overflow check on 32-bit arches The devmap code allocates a number hash buckets equal to the next power of two of the max_entries value provided when creating the map. When rounding up to the next power of two, the 32-bit variable storing the number of buckets can overflow, and the code checks for overflow by checking if the truncated 32-bit value is equal to 0. However, on 32-bit arches the rounding up itself can overflow mid-way through, because it ends up doing a left-shift of 32 bits on an unsigned long value. If the size of an unsigned long is four bytes, this is undefined behaviour, so there is no guarantee that we'll end up with a nice and tidy 0-value at the end. Syzbot managed to turn this into a crash on arm32 by creating a DEVMAP_HASH with max_entries > 0x80000000 and then trying to update it. Fix this by moving the overflow check to before the rounding up operation.",
	"refs": [
		{
			"text": "https://git.kernel.org/stable/c/22079b3a423382335f47d9ed32114e6c9fe88d7c",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/22079b3a423382335f47d9ed32114e6c9fe88d7c"
		},
		{
			"text": "https://git.kernel.org/stable/c/225da02acdc97af01b6bc6ce1a3e5362bf01d3fb",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/225da02acdc97af01b6bc6ce1a3e5362bf01d3fb"
		},
		{
			"text": "https://git.kernel.org/stable/c/250051acc21f9d4c5c595e4fcb55986ea08c4691",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/250051acc21f9d4c5c595e4fcb55986ea08c4691"
		},
		{
			"text": "https://git.kernel.org/stable/c/281d464a34f540de166cee74b723e97ac2515ec3",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/281d464a34f540de166cee74b723e97ac2515ec3"
		},
		{
			"text": "https://git.kernel.org/stable/c/c826502bed93970f2fd488918a7b8d5f1d30e2e3",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/c826502bed93970f2fd488918a7b8d5f1d30e2e3"
		},
		{
			"text": "https://git.kernel.org/stable/c/e89386f62ce9a9ab9a94835a9890883c23d9d52c",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/e89386f62ce9a9ab9a94835a9890883c23d9d52c"
		},
		{
			"text": "https://git.kernel.org/stable/c/edf7990baa48de5097daa9ac02e06cb4c798a737",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/edf7990baa48de5097daa9ac02e06cb4c798a737"
		}
	],
	"votes": {}
}
