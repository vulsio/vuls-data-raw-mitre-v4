{
	"name": "CVE-2024-35801",
	"seq": "2024-35801",
	"type": "CAN",
	"status": "Candidate",
	"phase": {
		"text": "Assigned",
		"date": "20240517"
	},
	"desc": "In the Linux kernel, the following vulnerability has been resolved: x86/fpu: Keep xfd_state in sync with MSR_IA32_XFD Commit 672365477ae8 (\"x86/fpu: Update XFD state where required\") and commit 8bf26758ca96 (\"x86/fpu: Add XFD state to fpstate\") introduced a per CPU variable xfd_state to keep the MSR_IA32_XFD value cached, in order to avoid unnecessary writes to the MSR. On CPU hotplug MSR_IA32_XFD is reset to the init_fpstate.xfd, which wipes out any stale state. But the per CPU cached xfd value is not reset, which brings them out of sync. As a consequence a subsequent xfd_update_state() might fail to update the MSR which in turn can result in XRSTOR raising a #NM in kernel space, which crashes the kernel. To fix this, introduce xfd_set_state() to write xfd_state together with MSR_IA32_XFD, and use it in all places that set MSR_IA32_XFD.",
	"refs": [
		{
			"text": "https://git.kernel.org/stable/c/10e4b5166df9ff7a2d5316138ca668b42d004422",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/10e4b5166df9ff7a2d5316138ca668b42d004422"
		},
		{
			"text": "https://git.kernel.org/stable/c/1acbca933313aa866e39996904c9aca4d435c4cd",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/1acbca933313aa866e39996904c9aca4d435c4cd"
		},
		{
			"text": "https://git.kernel.org/stable/c/21c7c00dae55cb0e3810d5f9506b58f68475d41d",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/21c7c00dae55cb0e3810d5f9506b58f68475d41d"
		},
		{
			"text": "https://git.kernel.org/stable/c/92b0f04e937665bde5768f3fcc622dcce44413d8",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/92b0f04e937665bde5768f3fcc622dcce44413d8"
		},
		{
			"text": "https://git.kernel.org/stable/c/b61e3b7055ac6edee4be071c52f48c26472d2624",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/b61e3b7055ac6edee4be071c52f48c26472d2624"
		}
	],
	"votes": {}
}
