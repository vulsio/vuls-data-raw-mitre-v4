{
	"name": "CVE-2021-47556",
	"seq": "2021-47556",
	"type": "CAN",
	"status": "Candidate",
	"phase": {
		"text": "Assigned",
		"date": "20240524"
	},
	"desc": "In the Linux kernel, the following vulnerability has been resolved: ethtool: ioctl: fix potential NULL deref in ethtool_set_coalesce() ethtool_set_coalesce() now uses both the .get_coalesce() and .set_coalesce() callbacks. But the check for their availability is buggy, so changing the coalesce settings on a device where the driver provides only _one_ of the callbacks results in a NULL pointer dereference instead of an -EOPNOTSUPP. Fix the condition so that the availability of both callbacks is ensured. This also matches the netlink code. Note that reproducing this requires some effort - it only affects the legacy ioctl path, and needs a specific combination of driver options: - have .get_coalesce() and .coalesce_supported but no .set_coalesce(), or - have .set_coalesce() but no .get_coalesce(). Here eg. ethtool doesn't cause the crash as it first attempts to call ethtool_get_coalesce() and bails out on error.",
	"refs": [
		{
			"text": "https://git.kernel.org/stable/c/0276af2176c78771da7f311621a25d7608045827",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/0276af2176c78771da7f311621a25d7608045827"
		},
		{
			"text": "https://git.kernel.org/stable/c/abfdd9e2f0f9699015d72317f74154d3e53664e6",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/abfdd9e2f0f9699015d72317f74154d3e53664e6"
		}
	],
	"votes": {}
}
