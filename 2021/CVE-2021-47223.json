{
	"name": "CVE-2021-47223",
	"seq": "2021-47223",
	"type": "CAN",
	"status": "Candidate",
	"phase": {
		"text": "Assigned",
		"date": "20240410"
	},
	"desc": "In the Linux kernel, the following vulnerability has been resolved: net: bridge: fix vlan tunnel dst null pointer dereference This patch fixes a tunnel_dst null pointer dereference due to lockless access in the tunnel egress path. When deleting a vlan tunnel the tunnel_dst pointer is set to NULL without waiting a grace period (i.e. while it's still usable) and packets egressing are dereferencing it without checking. Use READ/WRITE_ONCE to annotate the lockless use of tunnel_id, use RCU for accessing tunnel_dst and make sure it is read only once and checked in the egress path. The dst is already properly RCU protected so we don't need to do anything fancy than to make sure tunnel_id and tunnel_dst are read only once and checked in the egress path.",
	"refs": [
		{
			"text": "https://git.kernel.org/stable/c/24a6e55f17aa123bc1fc54b7d3c410b41bc16530",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/24a6e55f17aa123bc1fc54b7d3c410b41bc16530"
		},
		{
			"text": "https://git.kernel.org/stable/c/58e2071742e38f29f051b709a5cca014ba51166f",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/58e2071742e38f29f051b709a5cca014ba51166f"
		},
		{
			"text": "https://git.kernel.org/stable/c/a2241e62f6b4a774d8a92048fdf59c45f6c2fe5c",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/a2241e62f6b4a774d8a92048fdf59c45f6c2fe5c"
		},
		{
			"text": "https://git.kernel.org/stable/c/abb02e05cb1c0a30dd873a29f33bc092067dc35d",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/abb02e05cb1c0a30dd873a29f33bc092067dc35d"
		},
		{
			"text": "https://git.kernel.org/stable/c/ad7feefe7164892db424c45687472db803d87f79",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/ad7feefe7164892db424c45687472db803d87f79"
		},
		{
			"text": "https://git.kernel.org/stable/c/fe0448a3fad365a747283a00a1d1ad5e8d6675b7",
			"source": "MISC",
			"url": "https://git.kernel.org/stable/c/fe0448a3fad365a747283a00a1d1ad5e8d6675b7"
		}
	],
	"votes": {}
}
