{
	"name": "CVE-2004-1064",
	"seq": "2004-1064",
	"type": "CAN",
	"status": "Candidate",
	"phase": {
		"text": "Assigned",
		"date": "20041123"
	},
	"desc": "The safe mode checks in PHP 4.x to 4.3.9 and PHP 5.x to 5.0.2 truncate the file path before passing the data to the realpath function, which could allow attackers to bypass safe mode.  NOTE: this issue was originally REJECTed by its CNA before publication, but that decision is in active dispute.  This candidate may change significantly in the future as a result of further discussion.",
	"refs": [
		{
			"text": "11964",
			"source": "BID",
			"url": "http://www.securityfocus.com/bid/11964"
		},
		{
			"text": "20041215 Advisory 01/2004: Multiple vulnerabilities in PHP 4/5",
			"source": "BUGTRAQ",
			"url": "http://www.securityfocus.com/archive/1/384545"
		},
		{
			"text": "CLA-2005:915",
			"source": "CONECTIVA",
			"url": "http://distro.conectiva.com.br/atualizacoes/?id=a&amp;anuncio=000915"
		},
		{
			"text": "http://www.php.net/release_4_3_10.php",
			"source": "CONFIRM",
			"url": "http://www.php.net/release_4_3_10.php"
		},
		{
			"text": "GLSA-200412-14",
			"source": "GENTOO",
			"url": "http://www.gentoo.org/security/en/glsa/glsa-200412-14.xml"
		},
		{
			"text": "HPSBMA01212",
			"source": "HP",
			"url": "http://www.securityfocus.com/advisories/9028"
		},
		{
			"text": "MDKSA-2004:151",
			"source": "MANDRAKE",
			"url": "http://www.mandriva.com/security/advisories?name=MDKSA-2004:151"
		},
		{
			"text": "MDKSA-2005:072",
			"source": "MANDRAKE",
			"url": "http://www.mandriva.com/security/advisories?name=MDKSA-2005:072"
		},
		{
			"text": "http://www.hardened-php.net/advisories/012004.txt",
			"source": "MISC",
			"url": "http://www.hardened-php.net/advisories/012004.txt"
		},
		{
			"text": "USN-99-1",
			"source": "UBUNTU",
			"url": "https://www.ubuntu.com/usn/usn-99-1/"
		},
		{
			"text": "USN-99-2",
			"source": "UBUNTU",
			"url": "https://www.ubuntu.com/usn/usn-99-2/"
		},
		{
			"text": "php-realpath-safemode-bypass(18512)",
			"source": "XF",
			"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/18512"
		}
	],
	"votes": {
		"reviewing": {
			"text": "Christey",
			"count": "1"
		}
	},
	"comments": [
		{
			"text": "There is active disagreement regarding whether this satisfies the\ncriteria for inclusion in CVE, because the attack vectors require\nfunction parameters that are typically controlled only by the\napplication developer, not an external attacker.  This would mean that\nonly the PHP application owner could exploit it.\n\nSince various PHP functions already allow the application owner to\nexecute commands, no additional privileges would be gained by\nexploiting such a bug.  However, if safe_mode is enabled in PHP, then\nthe PHP functions related to execution are restricted\n(e.g. shell_exec()).  Thus, exploitation may allow the PHP application\nowner to execute code *despite* the configured restrictions imposed by\nsafe mode, which then qualifies this as a vulnerability.",
			"voter": "Christey"
		}
	]
}
