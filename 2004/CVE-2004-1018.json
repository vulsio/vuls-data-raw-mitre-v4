{
	"name": "CVE-2004-1018",
	"seq": "2004-1018",
	"type": "CAN",
	"status": "Candidate",
	"phase": {
		"text": "Assigned",
		"date": "20041104"
	},
	"desc": "Multiple integer handling errors in PHP before 4.3.10 allow attackers to bypass safe mode restrictions, cause a denial of service, or execute arbitrary code via (1) a negative offset value to the shmop_write function, (2) an \"integer overflow/underflow\" in the pack function, or (3) an \"integer overflow/underflow\" in the unpack function.  NOTE: this issue was originally REJECTed by its CNA before publication, but that decision is in active dispute.  This candidate may change significantly in the future as a result of further discussion.",
	"refs": [
		{
			"text": "12045",
			"source": "BID",
			"url": "http://www.securityfocus.com/bid/12045"
		},
		{
			"text": "20041215 Advisory 01/2004: Multiple vulnerabilities in PHP 4/5",
			"source": "BUGTRAQ",
			"url": "http://marc.info/?l=bugtraq&amp;m=110314318531298&amp;w=2"
		},
		{
			"text": "20041219 PHP shmop.c module permits write of arbitrary memory.",
			"source": "BUGTRAQ",
			"url": "http://www.securityfocus.com/archive/1/384920"
		},
		{
			"text": "http://www.php.net/release_4_3_10.php",
			"source": "CONFIRM",
			"url": "http://www.php.net/release_4_3_10.php"
		},
		{
			"text": "FLSA:2344",
			"source": "FEDORA",
			"url": "https://bugzilla.fedora.us/show_bug.cgi?id=2344"
		},
		{
			"text": "HPSBMA01212",
			"source": "HP",
			"url": "http://www.securityfocus.com/advisories/9028"
		},
		{
			"text": "MDKSA-2004:151",
			"source": "MANDRAKE",
			"url": "http://www.mandriva.com/security/advisories?name=MDKSA-2004:151"
		},
		{
			"text": "MDKSA-2005:072",
			"source": "MANDRAKE",
			"url": "http://www.mandriva.com/security/advisories?name=MDKSA-2005:072"
		},
		{
			"text": "http://www.hardened-php.net/advisories/012004.txt",
			"source": "MISC",
			"url": "http://www.hardened-php.net/advisories/012004.txt"
		},
		{
			"text": "12411",
			"source": "OSVDB",
			"url": "http://www.osvdb.org/12411"
		},
		{
			"text": "oval:org.mitre.oval:def:10949",
			"source": "OVAL",
			"url": "https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A10949"
		},
		{
			"text": "RHSA-2005:032",
			"source": "REDHAT",
			"url": "http://www.redhat.com/support/errata/RHSA-2005-032.html"
		},
		{
			"text": "RHSA-2005:816",
			"source": "REDHAT",
			"url": "http://www.redhat.com/support/errata/RHSA-2005-816.html"
		},
		{
			"text": "USN-99-1",
			"source": "UBUNTU",
			"url": "https://www.ubuntu.com/usn/usn-99-1/"
		},
		{
			"text": "php-shmopwrite-outofbounds-memory(18515)",
			"source": "XF",
			"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/18515"
		}
	],
	"votes": {
		"reviewing": {
			"text": "Christey",
			"count": "1"
		}
	},
	"comments": [
		{
			"text": "There is active disagreement regarding whether this satisfies the\ncriteria for inclusion in CVE, because the attack vectors require\nfunction parameters that are typically controlled only by the\napplication developer, not an external attacker.  This would mean that\nthe PHP application owner could exploit it\n\nSince various PHP functions already allow the application owner to\nexecute commands, no additional privileges would be gained by\nexploiting such a bug.  However, if safe_mode is enabled in PHP, then\nthe PHP functions related to execution are restricted\n(e.g. shell_exec()).  Thus, exploitation may allow the PHP application\nowner to execute code *despite* the configured restrictions imposed by\nsafe mode, which then qualifies this as a vulnerability.",
			"voter": "Christey"
		}
	]
}
